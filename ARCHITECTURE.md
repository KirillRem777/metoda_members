# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞–≥–∏–Ω–∞ Metoda Community MGMT

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±—â–∏–π –æ–±–∑–æ—Ä](#–æ–±—â–∏–π-–æ–±–∑–æ—Ä)
2. [–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#—Ñ–∞–π–ª–æ–≤–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
4. [–ö–ª–∞—Å—Å—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ](#–∫–ª–∞—Å—Å—ã-–∏-–∏—Ö-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ)
5. [AJAX Endpoints](#ajax-endpoints)
6. [–°–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤](#—Å–∏—Å—Ç–µ–º–∞-—à–∞–±–ª–æ–Ω–æ–≤)
7. [–ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –ø–æ—Å—Ç–æ–≤ –∏ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏](#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-—Ç–∏–ø—ã-–ø–æ—Å—Ç–æ–≤-–∏-—Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏)
8. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
9. [–í–∞–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏](#–≤–∞–∂–Ω—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏)

---

## –û–±—â–∏–π –æ–±–∑–æ—Ä

**Metoda Community MGMT** ‚Äî WordPress –ø–ª–∞–≥–∏–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Å—Ç–Ω—ã–º —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º –º–µ—Ç–æ–¥–∏—Å—Ç–æ–≤ –∏ —ç–∫—Å–ø–µ—Ä—Ç–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏ (–∫–∞—Å—Ç–æ–º–Ω—ã–π post type)
- ‚úÖ –õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã —Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–æ–º
- ‚úÖ –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å WYSIWYG —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º
- ‚úÖ –§–æ—Ä—É–º –≤ —Å—Ç–∏–ª–µ Reddit —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ CSV –∏–º–ø–æ—Ä—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- ‚úÖ –§–æ—Ç–æ-–∫—Ä–æ–ø–ø–µ—Ä –∏ –≥–∞–ª–µ—Ä–µ—è
- ‚úÖ –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –í–µ—Ä—Å–∏—è: 3.4.4
### –ê–≤—Ç–æ—Ä: Kirill Rem

---

## –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
metoda_members/
‚îú‚îÄ‚îÄ members-management-pro.php          # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–ª–∞–≥–∏–Ω–∞
‚îú‚îÄ‚îÄ single-members.php                  # –®–∞–±–ª–æ–Ω –ø—Ä–æ—Ñ–∏–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
‚îú‚îÄ‚îÄ ARCHITECTURE.md                     # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ DOCUMENTATION.md                    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ includes/                           # PHP –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ class-member-user-link.php      # –°–≤—è–∑—å WP User ‚Üî Member Post
‚îÇ   ‚îú‚îÄ‚îÄ class-member-page-templates.php # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ class-member-csv-importer.php   # CSV –∏–º–ø–æ—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ class-member-email-templates.php# Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ class-member-access-codes.php   # –ö–æ–¥—ã –¥–æ—Å—Ç—É–ø–∞
‚îÇ   ‚îú‚îÄ‚îÄ class-member-bulk-users.php     # –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ class-member-dashboard.php      # –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ class-member-file-manager.php   # –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ class-member-manager.php        # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ class-member-archive.php        # –ê—Ä—Ö–∏–≤ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ class-member-forum.php          # –§–æ—Ä—É–º
‚îÇ   ‚îú‚îÄ‚îÄ class-member-onboarding.php     # –û–Ω–±–æ—Ä–¥–∏–Ω–≥
‚îÇ   ‚îî‚îÄ‚îÄ class-member-template-loader.php# –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ templates/                          # –®–∞–±–ª–æ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ archive-members.php             # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ member-card.php                 # –ö–∞—Ä—Ç–æ—á–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ member-dashboard.php            # –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ member-registration.php         # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ custom-login.php                # –í—Ö–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ forgot-password.php             # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ reset-password.php              # –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ forum-archive.php               # –ì–ª–∞–≤–Ω–∞—è —Ñ–æ—Ä—É–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ forum-topic.php                 # –û–¥–Ω–∞ —Ç–µ–º–∞ —Ñ–æ—Ä—É–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ forum-listing.php               # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ —Ç–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ materials-section.php           # –°–µ–∫—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ material-card.php               # –ö–∞—Ä—Ç–æ—á–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ dashboard-materials-section.php # –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
‚îÇ   ‚îú‚îÄ‚îÄ dashboard-material-item.php     # –≠–ª–µ–º–µ–Ω—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ dashboard-messages-section.php  # –°–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
‚îÇ   ‚îî‚îÄ‚îÄ dashboard-forum-section.php     # –§–æ—Ä—É–º –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
‚îÇ
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ css/                            # –°—Ç–∏–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ member-archive.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ member-dashboard.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ member-forum.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ member-onboarding.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ js/                             # JavaScript
‚îÇ       ‚îú‚îÄ‚îÄ member-archive.js
‚îÇ       ‚îú‚îÄ‚îÄ member-dashboard.js
‚îÇ       ‚îú‚îÄ‚îÄ member-forum.js
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ Photos/                             # –î–µ–º–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã WordPress

#### 1. `wp_posts` - –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

```sql
-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
post_type = 'members'
post_title = "–ò–º—è –§–∞–º–∏–ª–∏—è"
post_status = 'publish'
post_author = ID —Å–æ–∑–¥–∞—Ç–µ–ª—è

-- –¢–æ–ø–∏–∫–∏ —Ñ–æ—Ä—É–º–∞
post_type = 'forum_topic'
post_title = "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã"
post_content = "–¢–µ–∫—Å—Ç –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"

-- –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
post_type = 'member_message'
post_title = "–¢–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏—è"
post_content = "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (HTML)"
```

#### 2. `wp_postmeta` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

**–î–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (post_type='members'):**
```sql
_linked_user_id         ‚Üí ID —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ WordPress –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
member_position         ‚Üí –î–æ–ª–∂–Ω–æ—Å—Ç—å
member_company          ‚Üí –ö–æ–º–ø–∞–Ω–∏—è/–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
member_email            ‚Üí Email
member_phone            ‚Üí –¢–µ–ª–µ—Ñ–æ–Ω
member_bio              ‚Üí –û —Å–µ–±–µ
member_specialization   ‚Üí –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
member_experience       ‚Üí –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã
member_interests        ‚Üí –ò–Ω—Ç–µ—Ä–µ—Å—ã
member_linkedin         ‚Üí LinkedIn URL
member_website          ‚Üí –í–µ–±—Å–∞–π—Ç
member_expectations     ‚Üí –û–∂–∏–¥–∞–Ω–∏—è –æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞
member_gallery          ‚Üí ID —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (comma-separated)
member_articles         ‚Üí JSON –º–∞—Å—Å–∏–≤ —Å—Ç–∞—Ç–µ–π
member_gratitudes       ‚Üí JSON –º–∞—Å—Å–∏–≤ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π
member_interviews       ‚Üí JSON –º–∞—Å—Å–∏–≤ –∏–Ω—Ç–µ—Ä–≤—å—é
member_videos           ‚Üí JSON –º–∞—Å—Å–∏–≤ –≤–∏–¥–µ–æ
member_reviews          ‚Üí JSON –º–∞—Å—Å–∏–≤ —Ä–µ—Ü–µ–Ω–∑–∏–π
member_developments     ‚Üí JSON –º–∞—Å—Å–∏–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–æ–∫
_profile_views          ‚Üí –°—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è
```

**–î–ª—è —Ç–æ–ø–∏–∫–æ–≤ —Ñ–æ—Ä—É–º–∞ (post_type='forum_topic'):**
```sql
author_member_id        ‚Üí ID —É—á–∞—Å—Ç–Ω–∏–∫–∞-–∞–≤—Ç–æ—Ä–∞
likes_count             ‚Üí –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤
liked_by_users          ‚Üí JSON –º–∞—Å—Å–∏–≤ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

**–î–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π (post_type='member_message'):**
```sql
sender_member_id        ‚Üí ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (Member post ID)
recipient_member_id     ‚Üí ID –ø–æ–ª—É—á–∞—Ç–µ–ª—è (Member post ID)
sender_name             ‚Üí –ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
message_read            ‚Üí 0/1 –ø—Ä–æ—á–∏—Ç–∞–Ω–æ –ª–∏
message_read_date       ‚Üí –î–∞—Ç–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è
```

#### 3. `wp_terms` + `wp_term_taxonomy` - –¢–∞–∫—Å–æ–Ω–æ–º–∏–∏

```sql
-- –¢–∏–ø—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
taxonomy = 'member_type'
terms = ['uchastnik', 'ekspert']

-- –†–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
taxonomy = 'member_role'
terms = ['–ú–µ—Ç–æ–¥–∏—Å—Ç', '–î–∏—Ä–µ–∫—Ç–æ—Ä', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä', ...]

-- –ì–æ—Ä–æ–¥–∞
taxonomy = 'member_location'
terms = ['–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', ...]

-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ñ–æ—Ä—É–º–∞
taxonomy = 'forum_category'
terms = ['–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã', '–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è', ...]
```

#### 4. `wp_users` - WordPress –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

```sql
ID                      ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
user_login              ‚Üí –õ–æ–≥–∏–Ω
user_email              ‚Üí Email
user_pass               ‚Üí –•–µ—à –ø–∞—Ä–æ–ª—è
```

#### 5. `wp_usermeta` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```sql
metoda_onboarding_seen  ‚Üí 1 –µ—Å–ª–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø—Ä–æ–π–¥–µ–Ω
metoda_access_code      ‚Üí –ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
```

#### 6. `wp_comments` - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Ñ–æ—Ä—É–º—É

```sql
comment_post_ID         ‚Üí ID —Ç–æ–ø–∏–∫–∞ —Ñ–æ—Ä—É–º–∞
comment_author          ‚Üí –ò–º—è –∞–≤—Ç–æ—Ä–∞
comment_content         ‚Üí –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
user_id                 ‚Üí ID WordPress –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

```
wp_users (ID=5)
    ‚Üì (—á–µ—Ä–µ–∑ _linked_user_id)
wp_postmeta ‚Üí post_id=123 (Member)
    ‚Üì
wp_posts (ID=123, post_type='members')
    ‚Üì
wp_term_relationships ‚Üí —Å–≤—è–∑—å —Å —Ç–∞–∫—Å–æ–Ω–æ–º–∏—è–º–∏
    ‚Üì
wp_terms (member_type='ekspert', member_location='–ú–æ—Å–∫–≤–∞')
```

---

## –ö–ª–∞—Å—Å—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

### 1. `Member_User_Link` (class-member-user-link.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–≤—è–∑—ã–≤–∞–µ—Ç WordPress –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ—Å—Ç–∞–º–∏ —Ç–∏–ø–∞ `members`

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```php
get_current_user_member_id()        // –ü–æ–ª—É—á–∏—Ç—å ID –ø–æ—Å—Ç–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —é–∑–µ—Ä–∞
link_user_to_member($user_id, $member_id)  // –°–æ–∑–¥–∞—Ç—å —Å–≤—è–∑—å
can_user_edit_member($member_id)    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
get_member_by_user_id($user_id)     // –ù–∞–π—Ç–∏ Member –ø–æ User ID
```

**SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞:**
```sql
SELECT post_id FROM wp_postmeta
WHERE meta_key = '_linked_user_id'
AND meta_value = '{current_user_id}'
```

---

### 2. `Member_Dashboard` (class-member-dashboard.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```php
get_member_data($member_id)         // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞
get_member_stats($member_id)        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –º–∞—Ç–µ—Ä–∏–∞–ª—ã)
ajax_update_profile()               // AJAX –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
ajax_update_gallery()               // AJAX –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–∏
```

**–í–∞–∂–Ω–æ:**
- –ê–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —á—É–∂–∏–µ –∫–∞–±–∏–Ω–µ—Ç—ã —á–µ—Ä–µ–∑ `?member_id=XXX`
- –ü—Ä–æ–≤–µ—Ä–∫–∞: `current_user_can('administrator')`

---

### 3. `Member_Template_Loader` (class-member-template-loader.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ –ø–ª–∞–≥–∏–Ω–∞

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```php
is_singular('members')              ‚Üí single-members.php
is_post_type_archive('members')     ‚Üí templates/archive-members.php
is_singular('forum_topic')          ‚Üí templates/forum-topic.php
is_post_type_archive('forum_topic') ‚Üí templates/forum-archive.php
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** theme > plugin

---

### 4. `Member_Archive` (class-member-archive.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—Ä—Ö–∏–≤ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```php
ajax_filter_members()               // AJAX —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
ajax_load_more_members()            // AJAX "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ"
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- `search` - –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏
- `city` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –≥–æ—Ä–æ–¥—É
- `role` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏
- `member_type` - —Ç–∏–ø (–≤—Å–µ/—É—á–∞—Å—Ç–Ω–∏–∫–∏/—ç–∫—Å–ø–µ—Ä—Ç—ã)

---

### 5. `Member_Forum` (class-member-forum.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Reddit-style —Ñ–æ—Ä—É–º

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```php
ajax_create_topic()                 // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É
ajax_like_topic()                   // –õ–∞–π–∫–Ω—É—Ç—å —Ç–µ–º—É
ajax_submit_comment()               // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –õ–∞–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `likes_count` + `liked_by_users` (JSON)
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É WordPress
- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö (`auth_redirect()`)

---

### 6. `Member_File_Manager` (class-member-file-manager.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:**
```php
'articles'      => '–°—Ç–∞—Ç—å–∏'
'gratitudes'    => '–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏'
'interviews'    => '–ò–Ω—Ç–µ—Ä–≤—å—é'
'videos'        => '–í–∏–¥–µ–æ'
'reviews'       => '–†–µ—Ü–µ–Ω–∑–∏–∏'
'developments'  => '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∏'
```

**–§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è:**
```json
[
  {
    "title": "–ù–∞–∑–≤–∞–Ω–∏–µ",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
    "link": "https://...",
    "file_url": "https://...",
    "video_url": "https://...",
    "image_url": "https://..."
  }
]
```

---

### 7. `Member_CSV_Importer` (class-member-csv-importer.php)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ CSV

**–§–æ—Ä–º–∞—Ç CSV:**
```csv
full_name,email,phone,position,company,city,type,role
–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤,ivan@test.ru,+7999...,–ú–µ—Ç–æ–¥–∏—Å—Ç,–®–∫–æ–ª–∞ ‚Ññ1,–ú–æ—Å–∫–≤–∞,uchastnik,–ú–µ—Ç–æ–¥–∏—Å—Ç
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –°–æ–∑–¥–∞–µ—Ç –ø–æ—Å—Ç —Ç–∏–ø–∞ `members`
2. –°–æ–∑–¥–∞–µ—Ç WordPress –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
3. –°–≤—è–∑—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ `_linked_user_id`
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞

---

## AJAX Endpoints

### –§–æ—Ä–º–∞—Ç –≤—ã–∑–æ–≤–∞
```javascript
$.ajax({
    url: '/wp-admin/admin-ajax.php',
    type: 'POST',
    data: {
        action: '–∏–º—è_—ç–∫—à–µ–Ω–∞',
        nonce: nonce_value,
        param1: value1
    }
});
```

### –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö endpoints

#### –ê—Ä—Ö–∏–≤ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
```php
add_action('wp_ajax_filter_members', ...)        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
add_action('wp_ajax_nopriv_filter_members', ...) // –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö

add_action('wp_ajax_load_more_members', ...)     // –ü–æ–¥–≥—Ä—É–∑–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
add_action('wp_ajax_nopriv_load_more_members', ...)
```

#### –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
```php
add_action('wp_ajax_member_update_profile', ...)    // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
add_action('wp_ajax_member_update_gallery', ...)    // –û–±–Ω–æ–≤–∏—Ç—å –≥–∞–ª–µ—Ä–µ—é
add_action('wp_ajax_mark_onboarding_seen', ...)     // –û—Ç–º–µ—Ç–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥

add_action('wp_ajax_add_material', ...)             // –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
add_action('wp_ajax_delete_material', ...)          // –£–¥–∞–ª–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
add_action('wp_ajax_upload_material_file', ...)     // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
```

#### –§–æ—Ä—É–º
```php
add_action('wp_ajax_create_topic', ...)             // –°–æ–∑–¥–∞—Ç—å —Ç–µ–º—É
add_action('wp_ajax_like_topic', ...)               // –õ–∞–π–∫–Ω—É—Ç—å —Ç–µ–º—É
add_action('wp_ajax_submit_comment', ...)           // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
```

#### –°–æ–æ–±—â–µ–Ω–∏—è
```php
add_action('wp_ajax_send_member_message', ...)      // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
add_action('wp_ajax_mark_message_read', ...)        // –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º
add_action('wp_ajax_delete_message', ...)           // –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
```

---

## –°–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤

### –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
1. –¢–µ–º–∞: `/wp-content/themes/current-theme/single-members.php`
2. –ü–ª–∞–≥–∏–Ω: `/wp-content/plugins/metoda_members/single-members.php`

**–ö–ª–∞—Å—Å:** `Member_Template_Loader`

### –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã

#### 1. `single-members.php` - –ü—Ä–æ—Ñ–∏–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
**–°–µ–∫—Ü–∏–∏:**
- –®–∞–ø–∫–∞ —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞–∑–∞–¥"
- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ñ–æ—Ç–æ, –∏–º—è, –¥–æ–ª–∂–Ω–æ—Å—Ç—å)
- –û —Å–µ–±–µ
- –û–∂–∏–¥–∞–Ω–∏—è –æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞
- –§–æ—Ç–æ–≥–∞–ª–µ—Ä–µ—è (—Å lightbox)
- –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (—Ç–∞–±—ã)
- –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Å–∞–π–¥–±–∞—Ä)
- –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ"

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö–Ω–æ–ø–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–∫—Ä—ã—Ç–∞ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
- Lightbox –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏ (—Å—Ç—Ä–µ–ª–∫–∏, ESC)
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- Quill editor –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π

#### 2. `templates/archive-members.php` - –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
**–°–µ–∫—Ü–∏–∏:**
- –®–∞–ø–∫–∞ —Å –ø–æ–∏—Å–∫–æ–º
- –§–∏–ª—å—Ç—Ä—ã (—Ç–∏–ø, –≥–æ—Ä–æ–¥, —Ä–æ–ª—å)
- –°–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ"

**–§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ AJAX:**
```javascript
// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞
action: 'filter_members'
// –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
```

#### 3. `templates/member-dashboard.php` - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
**–°–µ–∫—Ü–∏–∏:**
- –°–∞–π–¥–±–∞—Ä —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
- –ü—Ä–æ—Ñ–∏–ª—å (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã (CRUD)
- –§–æ—Ä—É–º (–º–æ–∏ —Ç–µ–º—ã)
- –°–æ–æ–±—â–µ–Ω–∏—è (–≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ)

**–†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–¥–º–∏–Ω–æ–º:**
```php
if ($is_admin && $_GET['member_id']) {
    // –ê–¥–º–∏–Ω –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —á—É–∂–æ–π –∫–∞–±–∏–Ω–µ—Ç
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∂–µ–ª—Ç—ã–π –±–∞–Ω–Ω–µ—Ä
}
```

#### 4. `templates/forum-archive.php` - –ì–ª–∞–≤–Ω–∞—è —Ñ–æ—Ä—É–º–∞
**–°–µ–∫—Ü–∏–∏:**
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (pills)
- –°–ø–∏—Å–æ–∫ —Ç–æ–ø–∏–∫–æ–≤ —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏
- –ú–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∞–≤—Ç–æ—Ä, –≤—Ä–µ–º—è, –ª–∞–π–∫–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è

**–î–∏–∑–∞–π–Ω:**
- Tailwind CSS
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π card-based layout
- Hover —ç—Ñ—Ñ–µ–∫—Ç—ã

---

## –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –ø–æ—Å—Ç–æ–≤ –∏ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ `members-management-pro.php`

#### 1. Post Type: `members`
```php
register_post_type('members', [
    'label' => '–£—á–∞—Å—Ç–Ω–∏–∫–∏',
    'public' => true,
    'has_archive' => true,
    'supports' => ['title', 'editor', 'thumbnail'],
    'show_in_rest' => true,
]);
```

#### 2. Post Type: `forum_topic`
```php
register_post_type('forum_topic', [
    'label' => '–¢–æ–ø–∏–∫–∏ —Ñ–æ—Ä—É–º–∞',
    'public' => true,
    'has_archive' => true,
    'supports' => ['title', 'editor', 'comments'],
]);
```

#### 3. Post Type: `member_message`
```php
register_post_type('member_message', [
    'label' => '–°–æ–æ–±—â–µ–Ω–∏—è',
    'public' => false,
    'show_ui' => true,
    'show_in_menu' => true,
]);
```

#### 4. Taxonomy: `member_type`
```php
register_taxonomy('member_type', 'members', [
    'label' => '–¢–∏–ø —É—á–∞—Å—Ç–Ω–∏–∫–∞',
    'hierarchical' => false,
]);
// Terms: 'uchastnik', 'ekspert'
```

#### 5. Taxonomy: `member_role`
```php
register_taxonomy('member_role', 'members', [
    'label' => '–†–æ–ª—å',
    'hierarchical' => false,
]);
```

#### 6. Taxonomy: `member_location`
```php
register_taxonomy('member_location', 'members', [
    'label' => '–ì–æ—Ä–æ–¥',
    'hierarchical' => false,
]);
```

#### 7. Taxonomy: `forum_category`
```php
register_taxonomy('forum_category', 'forum_topic', [
    'label' => '–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ñ–æ—Ä—É–º–∞',
    'hierarchical' => true,
]);
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend
- **Tailwind CSS** - utility-first CSS (—á–µ—Ä–µ–∑ CDN)
- **Font Awesome 6.4** - –∏–∫–æ–Ω–∫–∏
- **jQuery** - AJAX, DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏
- **Quill.js** - WYSIWYG —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π

### Backend
- **WordPress 5.0+**
- **PHP 7.4+**
- **MySQL** (—á–µ—Ä–µ–∑ WordPress DB API)

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **WordPress REST API** - —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- **WordPress Media Library** - –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- **WordPress Comments API** - –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Ñ–æ—Ä—É–º–∞

### CDN —Ä–µ—Å—É—Ä—Å—ã
```html
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
```

---

## –í–∞–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –°–≤—è–∑—å User ‚Üî Member

**–ü—Ä–æ–±–ª–µ–º–∞:** WordPress –∏–º–µ–µ—Ç `wp_users`, –Ω–æ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–µ–º `members` post type –∏ —Å–≤—è–∑—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ –º–µ—Ç–∞-–ø–æ–ª–µ

```php
// –ù–∞–π—Ç–∏ Member –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
$user_id = get_current_user_id();

$query = new WP_Query([
    'post_type' => 'members',
    'meta_query' => [
        [
            'key' => '_linked_user_id',
            'value' => $user_id,
            'compare' => '='
        ]
    ]
]);

$member_id = $query->posts[0]->ID;
```

### 2. –ê–¥–º–∏–Ω-–ø—Ä–æ—Å–º–æ—Ç—Ä —á—É–∂–∏—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤

**URL:** `/member-dashboard/?member_id=123`

**–õ–æ–≥–∏–∫–∞:**
```php
if (current_user_can('administrator') && isset($_GET['member_id'])) {
    $member_id = intval($_GET['member_id']);
    $is_viewing_other = true;
} else {
    $member_id = Member_User_Link::get_current_user_member_id();
    $is_viewing_other = false;
}
```

### 3. AJAX –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–î–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–∞ —Ö—É–∫–∞:**
```php
add_action('wp_ajax_filter_members', 'callback');           // –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
add_action('wp_ajax_nopriv_filter_members', 'callback');    // –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
```

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Nonce –¥–ª—è AJAX:**
```php
// –í PHP
wp_localize_script('script-handle', 'ajaxData', [
    'nonce' => wp_create_nonce('my_action_nonce')
]);

// –í JS
$.ajax({
    data: {
        action: 'my_action',
        nonce: ajaxData.nonce
    }
});

// –í PHP callback
check_ajax_referer('my_action_nonce', 'nonce');
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:**
```php
if (!current_user_can('administrator')) {
    wp_die('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞');
}
```

### 5. –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ JSON

**–ü–æ—á–µ–º—É JSON?**
- –ì–∏–±–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤)
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
- –õ–µ–≥–∫–æ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```json
[
  {
    "title": "–°—Ç–∞—Ç—å—è –æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏",
    "description": "–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ...",
    "link": "https://example.com/article",
    "image_url": "https://...",
    "file_url": null,
    "video_url": null
  }
]
```

### 6. –§–æ—Ä—É–º: –ª–∞–π–∫–∏ —á–µ—Ä–µ–∑ meta

**–ü–æ—á–µ–º—É –Ω–µ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞?**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞
- –ù–µ –Ω—É–∂–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- WordPress –Ω–∞—Ç–∏–≤–Ω–æ –∫–µ—à–∏—Ä—É–µ—Ç postmeta

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
// –ü–æ–ª—É—á–∞–µ–º –º–∞—Å—Å–∏–≤ ID —é–∑–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ª–∞–π–∫–Ω—É–ª–∏
$liked_by = json_decode(get_post_meta($topic_id, 'liked_by_users', true), true);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º
if (in_array($user_id, $liked_by)) {
    // –£–∂–µ –ª–∞–π–∫–Ω—É–ª - —É–¥–∞–ª—è–µ–º
    $liked_by = array_diff($liked_by, [$user_id]);
} else {
    // –ï—â–µ –Ω–µ –ª–∞–π–∫–Ω—É–ª - –¥–æ–±–∞–≤–ª—è–µ–º
    $liked_by[] = $user_id;
}

// –°–æ—Ö—Ä–∞–Ω—è–µ–º
update_post_meta($topic_id, 'liked_by_users', json_encode($liked_by));
update_post_meta($topic_id, 'likes_count', count($liked_by));
```

### 7. Template Loader Pattern

**–ó–∞—á–µ–º?**
- –ü–ª–∞–≥–∏–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ —Ç–µ–º–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
add_filter('template_include', function($template) {
    if (is_singular('members')) {
        $theme_template = locate_template(['single-members.php']);
        if (!$theme_template) {
            return plugin_dir_path(__FILE__) . 'single-members.php';
        }
    }
    return $template;
}, 99);
```

### 8. –°–æ–æ–±—â–µ–Ω–∏—è: –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–¥–º–∏–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–¥–º–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏, –Ω–æ —É –Ω–µ–≥–æ –Ω–µ—Ç Member post

**–†–µ—à–µ–Ω–∏–µ:**
```php
$sender_id = get_post_meta($message_id, 'sender_member_id', true);
if ($sender_id) {
    $sender_name = get_the_title($sender_id);
} else {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–¥–º–∏–Ω –ª–∏ –∞–≤—Ç–æ—Ä –ø–æ—Å—Ç–∞
    $post_author_id = get_post_field('post_author', $message_id);
    if (user_can($post_author_id, 'administrator')) {
        $sender_name = 'üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
    } else {
        $sender_name = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
    }
}
```

---

## –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ –∫ —É—á–∞—Å—Ç–Ω–∏–∫—É

1. **–í –∞–¥–º–∏–Ω–∫–µ** - –¥–æ–±–∞–≤–∏—Ç—å metabox –≤ `members-management-pro.php`:
```php
add_meta_box('member_new_field', '–ù–æ–≤–æ–µ –ø–æ–ª–µ', function($post) {
    $value = get_post_meta($post->ID, 'member_new_field', true);
    echo '<input name="member_new_field" value="' . esc_attr($value) . '">';
}, 'members');

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
add_action('save_post_members', function($post_id) {
    update_post_meta($post_id, 'member_new_field', $_POST['member_new_field']);
});
```

2. **–í —à–∞–±–ª–æ–Ω–µ** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
```php
$new_field = get_post_meta($member_id, 'member_new_field', true);
echo esc_html($new_field);
```

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä –≤ –∞—Ä—Ö–∏–≤

1. **–í `templates/archive-members.php`** - –¥–æ–±–∞–≤–∏—Ç—å HTML:
```html
<select id="new-filter">
    <option value="">–í—Å–µ</option>
    <option value="value1">–í–∞—Ä–∏–∞–Ω—Ç 1</option>
</select>
```

2. **–í JavaScript** - –¥–æ–±–∞–≤–∏—Ç—å –≤ `filterData`:
```javascript
const filterData = {
    action: 'filter_members',
    new_filter: $('#new-filter').val()
};
```

3. **–í PHP** - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤ `filter_members_ajax()`:
```php
$new_filter = isset($_POST['new_filter']) ? sanitize_text_field($_POST['new_filter']) : '';
if ($new_filter) {
    $args['meta_query'][] = [
        'key' => 'member_new_field',
        'value' => $new_filter,
        'compare' => '='
    ];
}
```

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π AJAX endpoint

1. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ö—É–∫:**
```php
add_action('wp_ajax_my_new_action', 'my_new_action_callback');
```

2. **–ù–∞–ø–∏—Å–∞—Ç—å callback:**
```php
function my_new_action_callback() {
    check_ajax_referer('my_nonce', 'nonce');

    $param = sanitize_text_field($_POST['param']);

    // –õ–æ–≥–∏–∫–∞

    wp_send_json_success(['result' => 'OK']);
}
```

3. **–í—ã–∑–≤–∞—Ç—å –∏–∑ JS:**
```javascript
$.ajax({
    url: ajaxurl,
    type: 'POST',
    data: {
        action: 'my_new_action',
        nonce: nonce_value,
        param: value
    },
    success: function(response) {
        console.log(response.data.result);
    }
});
```

---

## –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–∏—Ç—å debug —Ä–µ–∂–∏–º

–í `wp-config.php`:
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
define('WP_DEBUG_DISPLAY', false);
```

–õ–æ–≥–∏ –≤: `/wp-content/debug.log`

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ PHP

```php
error_log('–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: ' . print_r($var, true));
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JS

```javascript
console.log('Filter data:', filterData);
console.error('AJAX error:', xhr.responseText);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ AJAX –∑–∞–ø—Ä–æ—Å–æ–≤

**Chrome DevTools:**
1. F12 ‚Üí Network
2. –§–∏–ª—å—Ç—Ä: XHR
3. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å
4. Response tab - –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ WordPress

**Transients API:**
```php
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ 1 —á–∞—Å
set_transient('my_key', $data, HOUR_IN_SECONDS);

// –ü–æ–ª—É—á–∏—Ç—å
$data = get_transient('my_key');
if ($data === false) {
    // –ù–µ—Ç –≤ –∫–µ—à–µ - –≤—ã—á–∏—Å–ª–∏—Ç—å
}
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü–ª–æ—Ö–æ:**
```php
foreach ($members as $member) {
    $email = get_post_meta($member->ID, 'member_email', true); // N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
}
```

**–•–æ—Ä–æ—à–æ:**
```php
update_post_meta_cache($member_ids); // 1 –∑–∞–ø—Ä–æ—Å
foreach ($members as $member) {
    $email = get_post_meta($member->ID, 'member_email', true); // –ò–∑ –∫–µ—à–∞
}
```

---

## –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–æ—Ä–º–∞—Ç –≤–µ—Ä—Å–∏–π: MAJOR.MINOR.PATCH

- **MAJOR** - –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è API
- **MINOR** - –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ)
- **PATCH** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤

### –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: **3.4.4**

**Changelog:**
- 3.4.4 - –§–æ—Ä—É–º –∞—Ä—Ö–∏–≤, —Ñ–∏–∫—Å—ã –∞–¥–º–∏–Ω –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- 3.4.3 - –ö–æ–ª–æ–Ω–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ
- 3.4.2 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥—Ñ–∏–∫—Å—ã (redirect, filter, dashboard)
- 3.4.1 - –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–æ—Ä—É–º—É
- 3.4.0 - –ê–¥–º–∏–Ω –ª–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**GitHub:** https://github.com/KirillRem777/metoda_members
**–í–µ—Ç–∫–∞:** `claude/review-archive-solution-01BDVM9hSxbr8rj538dBC3X1`

**–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –≤ –Ω–æ–≤–æ–º —á–∞—Ç–µ:**
1. –ü—Ä–æ—á–∏—Ç–∞–π —ç—Ç–æ—Ç —Ñ–∞–π–ª (`ARCHITECTURE.md`)
2. –ü—Ä–æ—á–∏—Ç–∞–π `DOCUMENTATION.md` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
3. –ò–∑—É—á–∏ `members-management-pro.php` - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
4. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –≤ —Ä–∞–∑–¥–µ–ª–µ "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –¥–ª—è –≤–µ—Ä—Å–∏–∏ 3.4.4**
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 2025-11-20**
